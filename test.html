<!DOCTYPE html>
<html lang="vi">
    <head>
        <meta charset="UTF-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <title>ƒêƒÉng nh·∫≠p/ƒêƒÉng k√Ω</title>
        <style>
            body {
                font-family: Arial, sans-serif;
                display: flex;
                justify-content: center;
                align-items: center;
                height: 100vh;
                background-color: #f0f0f0;
                margin: 0;
            }

            .container {
                width: 300px;
                padding: 20px;
                background-color: white;
                box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
                border-radius: 10px;
                transition: all 0.5s ease-in-out;
            }

            .input-field {
                /* width: 100%; */
                width: 92%;
                padding: 10px;
                margin: 10px 0;
                border: 1px solid #ccc;
                border-radius: 5px;
            }

            .input-field:focus {
                border-color: #007bff;
                outline: none;
            }

            .btn {
                width: 100%;
                padding: 10px;
                margin: 10px 0;
                border: none;
                border-radius: 5px;
                background-color: #007bff;
                color: white;
                cursor: pointer;
                transition: background-color 0.3s ease;
            }

            .btn:hover {
                background-color: #0056b3;
            }

            .toggle {
                text-align: center;
                cursor: pointer;
                color: #007bff;
            }

            .hidden {
                display: none;
            }

            .show-password {
                position: relative;
            }

            .eye-icon {
                position: absolute;
                right: 10px;
                top: 50%;
                transform: translateY(-50%);
                cursor: pointer;
            }

            .error-message {
                color: red;
                text-align: center;
                margin-top: 10px;
                display: none;
            }

            .success-message {
                color: green;
                text-align: center;
                margin-top: 10px;
                display: none;
            }

            .fade-out {
                opacity: 0;
                transition: opacity 1s ease;
            }
        </style>
    </head>

    <body>
        <div class="container" id="login-container">
            <h2>ƒêƒÉng nh·∫≠p</h2>
            <input type="text" class="input-field" id="login-id" placeholder="Nh·∫≠p ID" maxlength="20" />
            <button class="btn" id="login-btn">ƒêƒÉng nh·∫≠p</button>
            <div class="toggle" id="toggle-register">Ch∆∞a c√≥ t√†i kho·∫£n? ƒêƒÉng k√Ω</div>
            <div class="error-message" id="login-error">Ch∆∞a nh·∫≠p m√£ l∆∞u.</div>
            <div id="loginError"></div>
        </div>
        <div class="container hidden" id="register-container">
            <h2>ƒêƒÉng k√Ω</h2>
            <input type="text" class="input-field" id="phone-number" placeholder="S·ªë ƒëi·ªán tho·∫°i" maxlength="10" />
            <div class="show-password">
                <input type="password" class="input-field" id="password" placeholder="M·∫≠t kh·∫©u" maxlength="6" />
                <span class="eye-icon" id="toggle-password">üëÅÔ∏è</span>
            </div>
            <button class="btn" id="register-btn">ƒêƒÉng k√Ω</button>
            <div class="toggle" id="toggle-login">ƒê√£ c√≥ t√†i kho·∫£n? ƒêƒÉng nh·∫≠p</div>
            <div class="error-message" id="register-error">Ch∆∞a nh·∫≠p s·ªë ƒëi·ªán tho·∫°i ho·∫∑c m·∫≠t kh·∫©u.</div>
            <div class="success-message" id="register-success">
                Ch√∫c m·ª´ng b·∫°n ƒë√£ ƒëƒÉng k√Ω t√†i kho·∫£n th√†nh c√¥ng.<br />
                H√£y ·∫•n l∆∞u m√£ n√†y: <span id="user-code"></span>
                <button class="btn" id="save-code-btn">L∆∞u m√£</button>
            </div>
        </div>
        <script>
            const validIDChars = [
                'ùïµ',
                'ùñÄ',
                'ùï≠',
                'ùïª',
                'ùïÆ',
                'ùïæ',
                'ùïø',
                'ùï∏',
                'ùïΩ',
                'ùï∫',
                '‚òá',
                '‚òà',
                '‚ùÄ',
                '‚ùà',
                '‚ú™',
                '‚úæ',
                '‚úÆ',
                '‚úß',
                '‚¨±',
                '‚ùñ',
                '‚öù',
                '‚éã',
                '‚òæ',
                '‚ôõ',
                '‚ôö',
                '‚ô°',
                '‚ù¶',
                '‚ú§',
                '‚ú≤',
                '‚ûô',
                '‚û™',
                '‚ç£',
                '‚åò',
                '‚éì',
                '‚úØ',
                '‚ô´',
                '_',
                '.',
            ];
            const phoneToCode = { 0: 'ùï∫', 1: 'ùïµ', 2: 'ùñÄ', 3: 'ùï≠', 4: 'ùïª', 5: 'ùïÆ', 6: 'ùïæ', 7: 'ùïø', 8: 'ùï∏', 9: 'ùïΩ' };
            const loginIDInput = document.getElementById('login-id');
            const phoneNumberInput = document.getElementById('phone-number');
            const passwordInput = document.getElementById('password');
            const togglePasswordBtn = document.getElementById('toggle-password');
            const loginBtn = document.getElementById('login-btn');
            const registerBtn = document.getElementById('register-btn');
            const saveCodeBtn = document.getElementById('save-code-btn');
            const loginError = document.getElementById('login-error');
            const registerError = document.getElementById('register-error');
            const registerSuccess = document.getElementById('register-success');
            const userCodeSpan = document.getElementById('user-code');
            const loginContainer = document.getElementById('login-container');
            const registerContainer = document.getElementById('register-container');
            const toggleLogin = document.getElementById('toggle-login');
            const toggleRegister = document.getElementById('toggle-register');
            let userCode = '';
            // Filter input for valid ID characters
            const allowedChars = 'ùïµùñÄùï≠ùïªùïÆùïæùïøùï∏ùïΩùï∫‚òá‚òà‚ùÄ‚ùà‚ú™‚úæ‚úÆ‚úß‚¨±‚ùñ‚öù‚éã‚òæ‚ôõ‚ôö‚ô°‚ù¶‚ú§‚ú≤‚ûô‚û™‚ç£‚åò‚éì‚úØ‚ô´_.';
            // Ki·ªÉm tra c√°c k√Ω t·ª± nh·∫≠p v√†o √¥ ID
            loginIDInput.addEventListener('input', () => {
                let inputValue = loginIDInput.value;
                let filteredValue = '';
                // Duy·ªát qua t·ª´ng k√Ω t·ª± ƒë·ªÉ ki·ªÉm tra xem n√≥ c√≥ trong allowedChars hay kh√¥ng
                for (let char of inputValue) {
                    if (allowedChars.includes(char)) {
                        filteredValue += char; // N·∫øu l√† k√Ω t·ª± h·ª£p l·ªá, th√™m v√†o chu·ªói m·ªõi
                    }
                }
                // C·∫≠p nh·∫≠t l·∫°i gi√° tr·ªã c·ªßa input ch·ªâ v·ªõi c√°c k√Ω t·ª± h·ª£p l·ªá
                loginIDInput.value = filteredValue;
            });

            // Chuy·ªÉn ƒë·ªïi gi·ªØa hi·ªÉn th·ªã/·∫©n m·∫≠t kh·∫©u v√† bi·ªÉu t∆∞·ª£ng
            togglePasswordBtn.addEventListener('click', () => {
                if (passwordInput.type === 'password') {
                    passwordInput.type = 'text';
                    togglePasswordBtn.innerHTML = 'üôà'; // Icon "m·∫Øt ƒë√≥ng"
                } else {
                    passwordInput.type = 'password';
                    togglePasswordBtn.innerHTML = 'üëÅÔ∏è'; // Icon "m·∫Øt m·ªü"
                }
            });

            // Chuy·ªÉn sang form ƒëƒÉng k√Ω
            toggleRegister.addEventListener('click', () => {
                loginContainer.classList.add('hidden');
                registerContainer.classList.remove('hidden');
            });
            // Chuy·ªÉn sang form ƒëƒÉng nh·∫≠p
            toggleLogin.addEventListener('click', () => {
                registerContainer.classList.add('hidden');
                loginContainer.classList.remove('hidden');
            });
            // H√†nh ƒë·ªông n√∫t ƒêƒÉng k√Ω
            // registerBtn.addEventListener('click', () => {
            //     const phone = phoneNumberInput.value;
            //     const password = passwordInput.value;
            //     if (phone === '' || password === '') {
            //         registerError.style.display = 'block';
            //         setTimeout(() => {
            //             registerError.classList.add('fade-out');
            //         }, 1000);
            //         setTimeout(() => {
            //             registerError.style.display = 'none';
            //             registerError.classList.remove('fade-out');
            //         }, 2000);
            //     } else {
            //         userCode = phone.split('').map(num => phoneToCode[num]).join('') + '_ùï∫';
            //         userCodeSpan.textContent = userCode;
            //         registerSuccess.style.display = 'block';
            //     }
            // });

            //         // H√†nh ƒë·ªông n√∫t ƒêƒÉng nh·∫≠p
            //        loginBtn.addEventListener('click', () => {
            //     const enteredCode = loginIDInput.value;
            //     // Ki·ªÉm tra n·∫øu √¥ nh·∫≠p tr·ªëng
            //     if (enteredCode === '') {
            //         loginError.style.display = 'block';
            //         loginError.textContent = 'Ch∆∞a nh·∫≠p m√£ l∆∞u.';
            //         setTimeout(() => {
            //             loginError.classList.add('fade-out');
            //         }, 1000);
            //         setTimeout(() => {
            //             loginError.style.display = 'none';
            //             loginError.classList.remove('fade-out');
            //         }, 2000);
            //     } else {
            //         // N·∫øu c√≥ m√£, in 'OK' ra console
            //         console.log('OK');
            //     }
            // });
            // x√≥a m·ªçi k√≠ t·ª± trong √¥ sdt
            phoneNumberInput.addEventListener('input', () => {
                phoneNumberInput.value = phoneNumberInput.value.replace(/\D/g, '');
            });
            // x√≥a m·ªçi kho·∫£ng c√°ch √¥ nh·∫≠p m·∫≠t kh·∫©u
            passwordInput.addEventListener('input', () => {
                // Lo·∫°i b·ªè t·∫•t c·∫£ c√°c k√Ω t·ª± kho·∫£ng tr·∫Øng
                passwordInput.value = passwordInput.value.replace(/\s/g, '');
            });

            // H√†nh ƒë·ªông n√∫t ƒêƒÉng k√Ω_L∆∞u M√£
            saveCodeBtn.addEventListener('click', () => {
                const codeToCopy = userCode;
                // Copy the code to clipboard
                navigator.clipboard
                    .writeText(codeToCopy)
                    .then(() => {
                        // console.log("M√£ ƒë√£ ƒë∆∞·ª£c sao ch√©p:", codeToCopy);
                        // Hi·ªÉn th·ªã th√¥ng b√°o sao ch√©p th√†nh c√¥ng
                        alert('M√£ ƒë√£ ƒë∆∞·ª£c sao ch√©p v√†o b·ªô nh·ªõ: ' + codeToCopy);
                        // ·∫®n b·∫£ng sau 1 gi√¢y
                        setTimeout(() => {
                            registerSuccess.classList.add('fade-out');
                        }, 700);
                        // Sau khi m√£ ƒë∆∞·ª£c sao ch√©p, chuy·ªÉn v·ªÅ b·∫£ng ƒëƒÉng nh·∫≠p
                        setTimeout(() => {
                            registerSuccess.style.display = 'none';
                            registerSuccess.classList.remove('fade-out');
                            setTimeout(() => {
                                toggleLogin.click(); // Automatically switch back to login form after saving
                            }, 700);
                        }, 1700);
                    })
                    .catch((err) => {
                        console.error('L·ªói khi sao ch√©p m√£: ', err);
                    });
            });

            // M·∫£ng k√Ω t·ª± ƒë·∫∑c bi·ªát ng·∫´u nhi√™n
            const specialChars = [
                '‚òá',
                '‚òà',
                '‚ùÄ',
                '‚ùà',
                '‚ú™',
                '‚úæ',
                '‚úÆ',
                '‚úß',
                '‚¨±',
                '‚ùñ',
                '‚öù',
                '‚éã',
                '‚òæ',
                '‚ôõ',
                '‚ôö',
                '‚ô°',
                '‚ù¶',
                '‚ú§',
                '‚ú≤',
                '‚ûô',
                '‚û™',
                '‚ç£',
                '‚åò',
                '‚éì',
                '‚úØ',
                '‚ô´',
            ];

            // H√†m t·∫°o chu·ªói ng·∫´u nhi√™n v·ªõi 3 k√Ω t·ª± tr∆∞·ªõc v√† 2 k√Ω t·ª± sau chu·ªói c·ªë ƒë·ªãnh ‚òæ‚åò, v√† 1 k√Ω t·ª± cu·ªëi l√† ‚òá
            function generateRandomSpecialString() {
                let randomStr = '';
                // Th√™m 3 k√Ω t·ª± ng·∫´u nhi√™n
                for (let i = 0; i < 3; i++) {
                    randomStr += specialChars[Math.floor(Math.random() * specialChars.length)];
                }
                // Th√™m chu·ªói c·ªë ƒë·ªãnh ‚òæ‚åò
                randomStr += '‚òæ‚åò';
                // Th√™m 2 k√Ω t·ª± ng·∫´u nhi√™n
                for (let i = 0; i < 2; i++) {
                    randomStr += specialChars[Math.floor(Math.random() * specialChars.length)];
                }
                // Th√™m k√Ω t·ª± c·ªë ƒë·ªãnh ‚òá
                randomStr += '‚òá';
                return randomStr;
            }

            // H√†nh ƒë·ªông n√∫t ƒêƒÉng k√Ω
            registerBtn.addEventListener('click', () => {
                const phone = phoneNumberInput.value;
                const password = passwordInput.value;

                if (phone === '' || password === '') {
                    registerError.style.display = 'block';
                    setTimeout(() => {
                        registerError.classList.add('fade-out');
                    }, 1000);
                    setTimeout(() => {
                        registerError.style.display = 'none';
                        registerError.classList.remove('fade-out');
                    }, 2000);
                } else {
                    // Chuy·ªÉn s·ªë ƒëi·ªán tho·∫°i th√†nh m√£
                    const phoneCode = phone
                        .split('')
                        .map((num) => phoneToCode[num])
                        .join('');

                    // T·∫°o chu·ªói ng·∫´u nhi√™n t·ª´ c√°c k√Ω t·ª± ƒë·∫∑c bi·ªát
                    const randomSpecialString = generateRandomSpecialString();

                    // K·∫øt h·ª£p chu·ªói ƒë·∫∑c bi·ªát v·ªõi m√£ v√† th√™m _ùï∫ v√†o cu·ªëi
                    userCode = `${phoneCode}_${randomSpecialString}_ùï∫`;

                    userCodeSpan.textContent = userCode;
                    registerSuccess.style.display = 'block';
                }
            });

            // H√†nh ƒë·ªông n√∫t ƒêƒÉng nh·∫≠p
            loginBtn.addEventListener('click', () => {
                const enteredCode = loginIDInput.value;
                // Ki·ªÉm tra n·∫øu √¥ nh·∫≠p tr·ªëng
                if (enteredCode === '') {
                    errorLogin('Ch∆∞a nh·∫≠p m√£ l∆∞u.');
                } else {
                    if (enteredCode.includes('_')) {
                        // T√¨m ƒëo·∫°n m√£ gi·ªØa d·∫•u _ th·ª© 1 v√† th·ª© 2
                        const parts = enteredCode.split('_');
                        const specialPart = parts[1]; // ƒêo·∫°n m√£ c·∫ßn ki·ªÉm tra

                        // Ki·ªÉm tra n·∫øu ƒëo·∫°n m√£ c√≥ ƒë·ªô d√†i 8 v√† c√°c k√Ω t·ª± ·ªü v·ªã tr√≠ c·ªë ƒë·ªãnh l√† ‚òæ‚åò v√† ‚òá
                        if (
                            specialPart.length === 8 &&
                            specialPart[3] === '‚òæ' &&
                            specialPart[4] === '‚åò' &&
                            specialPart[7] === '‚òá'
                        ) {
                            console.log('OK'); // M√£ ƒë√∫ng
                        } else {
                            errorLogin('M√£ l∆∞u sai.');
                        }
                    } else {
                        errorLogin('M√£ l∆∞u sai.');
                    }
                }
                function errorLogin(x) {
                    loginError.style.display = 'block';
                    loginError.textContent = x;
                    setTimeout(() => {
                        loginError.classList.add('fade-out');
                    }, 1000);
                    setTimeout(() => {
                        loginError.style.display = 'none';
                        loginError.classList.remove('fade-out');
                    }, 2000);
                }
            });
        </script>
    </body>
</html>
