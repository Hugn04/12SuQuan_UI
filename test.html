<!DOCTYPE html>
<html lang="vi">
    <head>
        <meta charset="UTF-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <title>ÄÄƒng nháº­p/ÄÄƒng kÃ½</title>
        <style>
            body {
                font-family: Arial, sans-serif;
                display: flex;
                justify-content: center;
                align-items: center;
                height: 100vh;
                background-color: #f0f0f0;
                margin: 0;
            }

            .container {
                width: 300px;
                padding: 20px;
                background-color: white;
                box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
                border-radius: 10px;
                transition: all 0.5s ease-in-out;
            }

            .input-field {
                /* width: 100%; */
                width: 92%;
                padding: 10px;
                margin: 10px 0;
                border: 1px solid #ccc;
                border-radius: 5px;
            }

            .input-field:focus {
                border-color: #007bff;
                outline: none;
            }

            .btn {
                width: 100%;
                padding: 10px;
                margin: 10px 0;
                border: none;
                border-radius: 5px;
                background-color: #007bff;
                color: white;
                cursor: pointer;
                transition: background-color 0.3s ease;
            }

            .btn:hover {
                background-color: #0056b3;
            }

            .toggle {
                text-align: center;
                cursor: pointer;
                color: #007bff;
            }

            .hidden {
                display: none;
            }

            .show-password {
                position: relative;
            }

            .eye-icon {
                position: absolute;
                right: 10px;
                top: 50%;
                transform: translateY(-50%);
                cursor: pointer;
            }

            .error-message {
                color: red;
                text-align: center;
                margin-top: 10px;
                display: none;
            }

            .success-message {
                color: green;
                text-align: center;
                margin-top: 10px;
                display: none;
            }

            .fade-out {
                opacity: 0;
                transition: opacity 1s ease;
            }
        </style>
    </head>

    <body>
        <div class="container" id="login-container">
            <h2>ÄÄƒng nháº­p</h2>
            <input type="text" class="input-field" id="login-id" placeholder="Nháº­p ID" maxlength="20" />
            <button class="btn" id="login-btn">ÄÄƒng nháº­p</button>
            <div class="toggle" id="toggle-register">ChÆ°a cÃ³ tÃ i khoáº£n? ÄÄƒng kÃ½</div>
            <div class="error-message" id="login-error">ChÆ°a nháº­p mÃ£ lÆ°u.</div>
            <div id="loginError"></div>
        </div>
        <div class="container hidden" id="register-container">
            <h2>ÄÄƒng kÃ½</h2>
            <input type="text" class="input-field" id="phone-number" placeholder="Sá»‘ Ä‘iá»‡n thoáº¡i" maxlength="10" />
            <div class="show-password">
                <input type="password" class="input-field" id="password" placeholder="Máº­t kháº©u" maxlength="6" />
                <span class="eye-icon" id="toggle-password">ğŸ‘ï¸</span>
            </div>
            <button class="btn" id="register-btn">ÄÄƒng kÃ½</button>
            <div class="toggle" id="toggle-login">ÄÃ£ cÃ³ tÃ i khoáº£n? ÄÄƒng nháº­p</div>
            <div class="error-message" id="register-error">ChÆ°a nháº­p sá»‘ Ä‘iá»‡n thoáº¡i hoáº·c máº­t kháº©u.</div>
            <div class="success-message" id="register-success">
                ChÃºc má»«ng báº¡n Ä‘Ã£ Ä‘Äƒng kÃ½ tÃ i khoáº£n thÃ nh cÃ´ng.<br />
                HÃ£y áº¥n lÆ°u mÃ£ nÃ y: <span id="user-code"></span>
                <button class="btn" id="save-code-btn">LÆ°u mÃ£</button>
            </div>
        </div>
        <script>
            const validIDChars = [
                'ğ•µ',
                'ğ–€',
                'ğ•­',
                'ğ•»',
                'ğ•®',
                'ğ•¾',
                'ğ•¿',
                'ğ•¸',
                'ğ•½',
                'ğ•º',
                'â˜‡',
                'â˜ˆ',
                'â€',
                'âˆ',
                'âœª',
                'âœ¾',
                'âœ®',
                'âœ§',
                'â¬±',
                'â–',
                'âš',
                'â‹',
                'â˜¾',
                'â™›',
                'â™š',
                'â™¡',
                'â¦',
                'âœ¤',
                'âœ²',
                'â™',
                'âª',
                'â£',
                'âŒ˜',
                'â“',
                'âœ¯',
                'â™«',
                '_',
                '.',
            ];
            const phoneToCode = { 0: 'ğ•º', 1: 'ğ•µ', 2: 'ğ–€', 3: 'ğ•­', 4: 'ğ•»', 5: 'ğ•®', 6: 'ğ•¾', 7: 'ğ•¿', 8: 'ğ•¸', 9: 'ğ•½' };
            const loginIDInput = document.getElementById('login-id');
            const phoneNumberInput = document.getElementById('phone-number');
            const passwordInput = document.getElementById('password');
            const togglePasswordBtn = document.getElementById('toggle-password');
            const loginBtn = document.getElementById('login-btn');
            const registerBtn = document.getElementById('register-btn');
            const saveCodeBtn = document.getElementById('save-code-btn');
            const loginError = document.getElementById('login-error');
            const registerError = document.getElementById('register-error');
            const registerSuccess = document.getElementById('register-success');
            const userCodeSpan = document.getElementById('user-code');
            const loginContainer = document.getElementById('login-container');
            const registerContainer = document.getElementById('register-container');
            const toggleLogin = document.getElementById('toggle-login');
            const toggleRegister = document.getElementById('toggle-register');
            let userCode = '';
            // Filter input for valid ID characters
            const allowedChars = 'ğ•µğ–€ğ•­ğ•»ğ•®ğ•¾ğ•¿ğ•¸ğ•½ğ•ºâ˜‡â˜ˆâ€âˆâœªâœ¾âœ®âœ§â¬±â–âšâ‹â˜¾â™›â™šâ™¡â¦âœ¤âœ²â™âªâ£âŒ˜â“âœ¯â™«_.';
            // Kiá»ƒm tra cÃ¡c kÃ½ tá»± nháº­p vÃ o Ã´ ID
            loginIDInput.addEventListener('input', () => {
                let inputValue = loginIDInput.value;
                let filteredValue = '';
                // Duyá»‡t qua tá»«ng kÃ½ tá»± Ä‘á»ƒ kiá»ƒm tra xem nÃ³ cÃ³ trong allowedChars hay khÃ´ng
                for (let char of inputValue) {
                    if (allowedChars.includes(char)) {
                        filteredValue += char; // Náº¿u lÃ  kÃ½ tá»± há»£p lá»‡, thÃªm vÃ o chuá»—i má»›i
                    }
                }
                // Cáº­p nháº­t láº¡i giÃ¡ trá»‹ cá»§a input chá»‰ vá»›i cÃ¡c kÃ½ tá»± há»£p lá»‡
                loginIDInput.value = filteredValue;
            });

            // Chuyá»ƒn Ä‘á»•i giá»¯a hiá»ƒn thá»‹/áº©n máº­t kháº©u vÃ  biá»ƒu tÆ°á»£ng
            togglePasswordBtn.addEventListener('click', () => {
                if (passwordInput.type === 'password') {
                    passwordInput.type = 'text';
                    togglePasswordBtn.innerHTML = 'ğŸ™ˆ'; // Icon "máº¯t Ä‘Ã³ng"
                } else {
                    passwordInput.type = 'password';
                    togglePasswordBtn.innerHTML = 'ğŸ‘ï¸'; // Icon "máº¯t má»Ÿ"
                }
            });

            // Chuyá»ƒn sang form Ä‘Äƒng kÃ½
            toggleRegister.addEventListener('click', () => {
                loginContainer.classList.add('hidden');
                registerContainer.classList.remove('hidden');
            });
            // Chuyá»ƒn sang form Ä‘Äƒng nháº­p
            toggleLogin.addEventListener('click', () => {
                registerContainer.classList.add('hidden');
                loginContainer.classList.remove('hidden');
            });
            // HÃ nh Ä‘á»™ng nÃºt ÄÄƒng kÃ½
            // registerBtn.addEventListener('click', () => {
            //     const phone = phoneNumberInput.value;
            //     const password = passwordInput.value;
            //     if (phone === '' || password === '') {
            //         registerError.style.display = 'block';
            //         setTimeout(() => {
            //             registerError.classList.add('fade-out');
            //         }, 1000);
            //         setTimeout(() => {
            //             registerError.style.display = 'none';
            //             registerError.classList.remove('fade-out');
            //         }, 2000);
            //     } else {
            //         userCode = phone.split('').map(num => phoneToCode[num]).join('') + '_ğ•º';
            //         userCodeSpan.textContent = userCode;
            //         registerSuccess.style.display = 'block';
            //     }
            // });

            //         // HÃ nh Ä‘á»™ng nÃºt ÄÄƒng nháº­p
            //        loginBtn.addEventListener('click', () => {
            //     const enteredCode = loginIDInput.value;
            //     // Kiá»ƒm tra náº¿u Ã´ nháº­p trá»‘ng
            //     if (enteredCode === '') {
            //         loginError.style.display = 'block';
            //         loginError.textContent = 'ChÆ°a nháº­p mÃ£ lÆ°u.';
            //         setTimeout(() => {
            //             loginError.classList.add('fade-out');
            //         }, 1000);
            //         setTimeout(() => {
            //             loginError.style.display = 'none';
            //             loginError.classList.remove('fade-out');
            //         }, 2000);
            //     } else {
            //         // Náº¿u cÃ³ mÃ£, in 'OK' ra console
            //         console.log('OK');
            //     }
            // });
            // xÃ³a má»i kÃ­ tá»± trong Ã´ sdt
            phoneNumberInput.addEventListener('input', () => {
                phoneNumberInput.value = phoneNumberInput.value.replace(/\D/g, '');
            });
            // xÃ³a má»i khoáº£ng cÃ¡ch Ã´ nháº­p máº­t kháº©u
            passwordInput.addEventListener('input', () => {
                // Loáº¡i bá» táº¥t cáº£ cÃ¡c kÃ½ tá»± khoáº£ng tráº¯ng
                passwordInput.value = passwordInput.value.replace(/\s/g, '');
            });

            // HÃ nh Ä‘á»™ng nÃºt ÄÄƒng kÃ½_LÆ°u MÃ£
            saveCodeBtn.addEventListener('click', () => {
                const codeToCopy = userCode;
                // Copy the code to clipboard
                navigator.clipboard
                    .writeText(codeToCopy)
                    .then(() => {
                        // console.log("MÃ£ Ä‘Ã£ Ä‘Æ°á»£c sao chÃ©p:", codeToCopy);
                        // Hiá»ƒn thá»‹ thÃ´ng bÃ¡o sao chÃ©p thÃ nh cÃ´ng
                        alert('MÃ£ Ä‘Ã£ Ä‘Æ°á»£c sao chÃ©p vÃ o bá»™ nhá»›: ' + codeToCopy);
                        // áº¨n báº£ng sau 1 giÃ¢y
                        setTimeout(() => {
                            registerSuccess.classList.add('fade-out');
                        }, 700);
                        // Sau khi mÃ£ Ä‘Æ°á»£c sao chÃ©p, chuyá»ƒn vá» báº£ng Ä‘Äƒng nháº­p
                        setTimeout(() => {
                            registerSuccess.style.display = 'none';
                            registerSuccess.classList.remove('fade-out');
                            setTimeout(() => {
                                toggleLogin.click(); // Automatically switch back to login form after saving
                            }, 700);
                        }, 1700);
                    })
                    .catch((err) => {
                        console.error('Lá»—i khi sao chÃ©p mÃ£: ', err);
                    });
            });

            // Máº£ng kÃ½ tá»± Ä‘áº·c biá»‡t ngáº«u nhiÃªn
            const specialChars = [
                'â˜‡',
                'â˜ˆ',
                'â€',
                'âˆ',
                'âœª',
                'âœ¾',
                'âœ®',
                'âœ§',
                'â¬±',
                'â–',
                'âš',
                'â‹',
                'â˜¾',
                'â™›',
                'â™š',
                'â™¡',
                'â¦',
                'âœ¤',
                'âœ²',
                'â™',
                'âª',
                'â£',
                'âŒ˜',
                'â“',
                'âœ¯',
                'â™«',
            ];

            // HÃ m táº¡o chuá»—i ngáº«u nhiÃªn vá»›i 3 kÃ½ tá»± trÆ°á»›c vÃ  2 kÃ½ tá»± sau chuá»—i cá»‘ Ä‘á»‹nh â˜¾âŒ˜, vÃ  1 kÃ½ tá»± cuá»‘i lÃ  â˜‡
            function generateRandomSpecialString() {
                let randomStr = '';
                // ThÃªm 3 kÃ½ tá»± ngáº«u nhiÃªn
                for (let i = 0; i < 3; i++) {
                    randomStr += specialChars[Math.floor(Math.random() * specialChars.length)];
                }
                // ThÃªm chuá»—i cá»‘ Ä‘á»‹nh â˜¾âŒ˜
                randomStr += 'â˜¾âŒ˜';
                // ThÃªm 2 kÃ½ tá»± ngáº«u nhiÃªn
                for (let i = 0; i < 2; i++) {
                    randomStr += specialChars[Math.floor(Math.random() * specialChars.length)];
                }
                // ThÃªm kÃ½ tá»± cá»‘ Ä‘á»‹nh â˜‡
                randomStr += 'â˜‡';
                return randomStr;
            }

            // HÃ nh Ä‘á»™ng nÃºt ÄÄƒng kÃ½
            registerBtn.addEventListener('click', () => {
                const phone = phoneNumberInput.value;
                const password = passwordInput.value;

                if (phone === '' || password === '') {
                    registerError.style.display = 'block';
                    setTimeout(() => {
                        registerError.classList.add('fade-out');
                    }, 1000);
                    setTimeout(() => {
                        registerError.style.display = 'none';
                        registerError.classList.remove('fade-out');
                    }, 2000);
                } else {
                    // Chuyá»ƒn sá»‘ Ä‘iá»‡n thoáº¡i thÃ nh mÃ£
                    const phoneCode = phone
                        .split('')
                        .map((num) => phoneToCode[num])
                        .join('');

                    // Táº¡o chuá»—i ngáº«u nhiÃªn tá»« cÃ¡c kÃ½ tá»± Ä‘áº·c biá»‡t
                    const randomSpecialString = generateRandomSpecialString();

                    // Káº¿t há»£p chuá»—i Ä‘áº·c biá»‡t vá»›i mÃ£ vÃ  thÃªm _ğ•º vÃ o cuá»‘i
                    userCode = `${phoneCode}_${randomSpecialString}_ğ•º`;

                    userCodeSpan.textContent = userCode;
                    registerSuccess.style.display = 'block';
                }
            });

            // HÃ nh Ä‘á»™ng nÃºt ÄÄƒng nháº­p
            loginBtn.addEventListener('click', () => {
                const enteredCode = loginIDInput.value;
                // Kiá»ƒm tra náº¿u Ã´ nháº­p trá»‘ng
                if (enteredCode === '') {
                    errorLogin('ChÆ°a nháº­p mÃ£ lÆ°u.');
                } else {
                    if (enteredCode.includes('_')) {
                        // TÃ¬m Ä‘oáº¡n mÃ£ giá»¯a dáº¥u _ thá»© 1 vÃ  thá»© 2
                        const parts = enteredCode.split('_');
                        const specialPart = parts[1]; // Äoáº¡n mÃ£ cáº§n kiá»ƒm tra

                        // Kiá»ƒm tra náº¿u Ä‘oáº¡n mÃ£ cÃ³ Ä‘á»™ dÃ i 8 vÃ  cÃ¡c kÃ½ tá»± á»Ÿ vá»‹ trÃ­ cá»‘ Ä‘á»‹nh lÃ  â˜¾âŒ˜ vÃ  â˜‡
                        if (
                            specialPart.length === 8 &&
                            specialPart[3] === 'â˜¾' &&
                            specialPart[4] === 'âŒ˜' &&
                            specialPart[7] === 'â˜‡'
                        ) {
                            console.log('OK'); // MÃ£ Ä‘Ãºng
                        } else {
                            errorLogin('MÃ£ lÆ°u sai.');
                        }
                    } else {
                        errorLogin('MÃ£ lÆ°u sai.');
                    }
                }
                function errorLogin(x) {
                    loginError.style.display = 'block';
                    loginError.textContent = x;
                    setTimeout(() => {
                        loginError.classList.add('fade-out');
                    }, 1000);
                    setTimeout(() => {
                        loginError.style.display = 'none';
                        loginError.classList.remove('fade-out');
                    }, 2000);
                }
            });
        </script>
    </body>
</html>
